<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    ul {
        size: 2em;
        font-weight: bolder;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .newEmperor {
        list-style-type: 'ðŸ‘‘';
    }
</style>

<body>
    <ul id="candidates"></ul>
</body>

</html>

<script>
    function delegate(parent, child, when, what) {
        function eventHandlerFunction(event) {
            let eventTarget = event.target
            let eventHandler = this
            let closestChild = eventTarget.closest(child)

            if (eventHandler.contains(closestChild)) {
                what(event, closestChild)
            }
        }

        parent.addEventListener(when, eventHandlerFunction)
    }
    /*
    candidateName: the name of the person that wants to be Emperor
    army: the size of the army of this person (it is not needed until task 3)
    likelyToVote: the name of the Electors who are likely to vote for this person (4 names means 4 votes for the candidate)
    */
    const candidates = [
        {
            candidateName: 'Paul Atreides',
            army: 22000,
            likelyToVote: ['Duke Simba Mufason', 'Paul Atreides', 'King Elrond of Rivendell']
        },
        {
            candidateName: 'Babar',
            army: 80000,
            likelyToVote: ['T\'Challa', 'Princess Bubblegum', 'Princess Zelda', 'Julien', 'King Shrek']
        },
        {
            candidateName: 'PadmÃ© Amidala',
            army: 34000,
            likelyToVote: ['Queen Elsa', 'Renly Baratheon', 'Kuzko']
        },
        {
            candidateName: 'Sheev Palpatine',
            army: 45000,
            likelyToVote: ['Duke Scar', 'Sheev Palpatine', 'Firelord Ozai', 'Bowser', 'The Imperial Senate', 'Queen Jadis of Narnia']
        },
        {
            candidateName: 'Daenerys Targaryen',
            army: 120000,
            likelyToVote: ['Jon Snow']
        },
        {
            candidateName: 'Julien',
            army: 12000,
            likelyToVote: ['Renly Baratheon', 'Retexis']
        }
    ]


    //Task 1
    console.log("The candidate likely to get the most votes is :", Task1());
    function Task1() {

        return candidates.reduce((a, b) => a.likelyToVote.length > b.likelyToVote.length ? a : b).candidateName

    }

    //Task2
    //I didnt understand wheteher to log just the names or all details of the candidates, so i logged all details
    console.log(
        candidates.filter(candidate => candidate.likelyToVote.includes(candidate.candidateName)) //.map(candidate => candidate.candidateName) to log only names
    );


    //Task3
    console.log(
        candidates.map(candidate => {
            return {
                candidateName: candidate.candidateName,
                points: candidate.likelyToVote.length * candidate.army / 1000
            }
        })
    );


    //Task4
    const candidates_list = document.getElementById('candidates');

    candidates.forEach(candidate => {
        const listWithPoints = document.createElement('li');
        listWithPoints.innerHTML = `${candidate.candidateName} (${candidate.likelyToVote.length * candidate.army / 1000})`;
        candidates_list.appendChild(listWithPoints);
    });


    //Task5

    function PutCrown(event, element) {
        const newEmperor = document.getElementsByClassName('newEmperor');
        // if (something) {
        //     newEmperor[0].classList.remove('newEmperor');
        // }
        if (newEmperor.length > 0) {
            newEmperor[0].classList.remove('newEmperor');
        }
        element.classList.add('newEmperor');
    }
    delegate(candidates_list, 'li', 'click', PutCrown);





</script>